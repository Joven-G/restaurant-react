ko.components.register("picker",{viewModel:function(n){var t=this;this.textTerm=ko.observable("").extend({rateLimit:500});this.minSearchText=ko.observable(n.minSearchText||2);this.multipleSelect=ko.observable(n.multipleSelect||!1);this.searchInputPlaceholder=ko.observable(n.searchInputPlaceholder||`Enter ${this.minSearchText()} or more characters`);this.selectedItemsTitle=ko.observable(n.selectedItemsTitle||"Selected: ");this.searchResultTitle=ko.observable(n.searchResultTitle||"Search result: ");this.suggestedItemsTitle=ko.observable(n.suggestedItemsTitle||"Suggested items: ");this.noItemSelectedTitle=ko.observable(n.noItemSelectedTitle||"No item/s selected");this.showAllItemsTitle=ko.observable(n.showAllItemsTitle||"more");this.allowSuggestedItems=ko.observable(n.allowSuggestedItems&&n.url||!1);this.topSuggestedItems=ko.observable(n.topSuggestedItems||5);this.allowItemAlreadySelectedNotification=ko.observable(n.allowItemAlreadySelectedNotification||!0);this.itemAlreadySelectedTitle=ko.observable(n.itemAlreadySelectedTitle||"item already selected");this.searchResult=ko.observableArray([]);this.selectedResult=ko.observableArray(n.selectedItems||[]);this.suggestedResult=ko.observableArray([]);this.loading=ko.observable(!1);const i=ko.toJSON(this.selectedResult);this.multipleSelect()===!0?this.selectedResult().length===0?$(`#${n.hiddenId}`).val(""):$(`#${n.hiddenId}`).val(i):this.selectedResult().length===0?$(`#${n.hiddenId}`).val(""):$(`#${n.hiddenId}`).val(this.selectedResult()[0]);this.textTerm.subscribe(function(i){i.trim()===""&&t.searchResult([]);i.trim()!==""&&i.trim().length>=t.minSearchText()&&(n.url?(t.loading(!0),$.get(`${n.url}=${i}`,function(n){n.indexOf(i)===-1&&n.push(i);t.searchResult(n);t.loading(!1)})):t.searchResult([i]))});this.notify=function(n){toastr.options.closeButton=!0;toastr.options.preventDuplicates=!0;toastr.info(`${n} ${this.itemAlreadySelectedTitle()}`)};this.add=function(n){if(n=n.replace(/'/g,"").replace(/"/g,""),this.selectedResult.indexOf(n)>-1){this.allowItemAlreadySelectedNotification()===!0&&this.notify(n);return}this.multipleSelect()===!1?(this.selectedResult([]),this.selectedResult.push(n),this.clear(),this.sync()):this.multipleSelect()===!0&&(this.selectedResult.push(n),this.clear(),this.sync())};this.getSuggestedItems=function(){t.allowSuggestedItems()!==!1&&n.url&&(t.loading(!0),$.get(n.url,{limit:t.topSuggestedItems()},function(n){t.suggestedResult(n);t.loading(!1)}))};this.clear=function(){this.textTerm("");t.searchResult([])};this.remove=function(n){this.selectedResult.remove(n);this.sync()};this.showAll=function(){n.url&&(t.loading(!0),$.get(`${n.url}`,function(n){t.suggestedResult(n);t.loading(!1)}))};this.sync=function(){const t=ko.toJSON(this.selectedResult);this.multipleSelect()===!0?this.selectedResult().length===0?$(`#${n.hiddenId}`).val(""):$(`#${n.hiddenId}`).val(t):this.selectedResult().length===0?$(`#${n.hiddenId}`).val(""):$(`#${n.hiddenId}`).val(this.selectedResult()[0])};t.getSuggestedItems()},template:'<div class="card"><div class="card-body"><input class="form-control" data-bind="textInput: textTerm, attr: {placeholder: searchInputPlaceholder}" /><hr data-bind="visible: searchResult().length > 0" /><div data-bind="visible: searchResult().length > 0, text: searchResultTitle" class="search-title"><\/div><div class="block__buttons__add" data-bind="foreach: searchResult"><input type="button" class="btn btn-primary button__add" data-bind="value: $data, click: function() { $parent.add($data); }"><\/div><img data-bind="visible: loading()" src="/images/loading.gif" alt="Loading.." /><hr /><div data-bind="visible: selectedResult().length == 0, text: noItemSelectedTitle" class="search-title"><\/div><div data-bind="visible: selectedResult().length > 0, text: selectedItemsTitle" class="search-title"><\/div><div data-bind="foreach: selectedResult"><button class="btn btn-outline-primary button__delete" data-bind="click: function() { $parent.remove($data); }"><span data-bind="text: $data"><\/span> <span class="oi oi-x"><\/span><\/button><\/div><hr data-bind="visible: suggestedResult().length > 0" /><div data-bind="visible: suggestedResult().length > 0, text: suggestedItemsTitle" class="search-title"><\/div><!-- ko foreach: suggestedResult --><input type="button" class="btn btn-light button__add" data-bind="value: $data, click: function() { $parent.add($data); }"><!-- /ko --><button class="btn btn-default button__show-all" data-bind="visible:allowSuggestedItems(), click: function() { $component.showAll(); }"><span data-bind="text: showAllItemsTitle"><\/span> <span class="oi oi-plus"><\/span><\/button><\/div><\/div>'});ko.applyBindings();